{
	"$schema": "https://railway.com/railway.schema.json",
	"build": {
		"builder": "NIXPACKS",
		"nixpacksPlan": {
			"providers": ["node"],
			"phases": {
				"setup": {
					"nixPkgs": ["ffmpeg", "nodejs_20"]
				},
				"install": {
					"cmds": ["npm install -g pnpm@10.5.2", "pnpm install --frozen-lockfile"]
				},
				"build": {
					"cmds": ["pnpm build"]
				}
			}
		}
	},
	"deploy": {
		"startCommand": "node apps/web/.next/standalone/apps/web/server.js",
		"healthcheckPath": "/api/health",
		"healthcheckTimeout": 300,
		"restartPolicyType": "ON_FAILURE",
		"restartPolicyMaxRetries": 3,
		"runtime": "V2"
	}
}
